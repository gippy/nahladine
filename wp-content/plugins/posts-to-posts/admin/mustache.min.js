(function(u,t){"object"===typeof exports&&exports?module.exports=t:"function"===typeof define&&define.amd?define(t):u.Mustache=t})(this,function(){function u(a){return a.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function t(a){this.tail=this.string=a;this.pos=0}function q(a,b){this.view=a;this.parent=b;this.clearCache()}function m(){this.clearCache()}function w(a){function b(a,b,g){if(!c[a]){var e=w(b);c[a]=function(a,b){return e(a,b,g)}}return c[a]}var c={};return function(c,f,g){for(var e="",
k,h,n=0,l=a.length;n<l;++n)switch(k=a[n],k[0]){case "#":h=g.slice(k[3],k[5]);e+=c._section(k[1],f,h,b(n,k[4],g));break;case "^":e+=c._inverted(k[1],f,b(n,k[4],g));break;case ">":e+=c._partial(k[1],f);break;case "&":e+=c._name(k[1],f);break;case "name":e+=c._escaped(k[1],f);break;case "text":e+=k[1]}return e}}function x(a){return[RegExp(u(a[0])+"\\s*"),RegExp("\\s*"+u(a[1]))]}var h={name:"mustache.js",version:"0.7.2",tags:["{{","}}"]};h.Scanner=t;h.Context=q;h.Writer=m;var B=/\s*/,y=/\s+/,C=/\S/,z=
/\s*=/,D=/\s*\}/,E=/#|\^|\/|>|\{|&|=|!/,A=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},F={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};h.escape=function(a){return String(a).replace(/[&<>"'\/]/g,function(a){return F[a]})};t.prototype.eos=function(){return""===this.tail};t.prototype.scan=function(a){return(a=this.tail.match(a))&&0===a.index?(this.tail=this.tail.substring(a[0].length),this.pos+=a[0].length,a[0]):""};t.prototype.scanUntil=
function(a){var b=this.tail.search(a);switch(b){case -1:a=this.tail;this.pos+=this.tail.length;this.tail="";break;case 0:a="";break;default:a=this.tail.substring(0,b),this.tail=this.tail.substring(b),this.pos+=b}return a};q.make=function(a){return a instanceof q?a:new q(a)};q.prototype.clearCache=function(){this._cache={}};q.prototype.push=function(a){return new q(a,this)};q.prototype.lookup=function(a){var b=this._cache[a];if(!b){if("."===a)b=this.view;else for(var c=this;c;){if(0<a.indexOf("."))for(var d=
a.split("."),f=0,b=c.view;b&&f<d.length;)b=b[d[f++]];else b=c.view[a];if(null!=b)break;c=c.parent}this._cache[a]=b}"function"===typeof b&&(b=b.call(this.view));return b};m.prototype.clearCache=function(){this._cache={};this._partialCache={}};m.prototype.compile=function(a,b){var c=this._cache[a];c||(c=h.parse(a,b),c=this._cache[a]=this.compileTokens(c,a));return c};m.prototype.compilePartial=function(a,b,c){b=this.compile(b,c);return this._partialCache[a]=b};m.prototype.compileTokens=function(a,b){var c=
w(a),d=this;return function(a,g){if(g)if("function"===typeof g)d._loadPartial=g;else for(var e in g)d.compilePartial(e,g[e]);return c(d,q.make(a),b)}};m.prototype.render=function(a,b,c){return this.compile(a)(b,c)};m.prototype._section=function(a,b,c,d){a=b.lookup(a);switch(typeof a){case "object":if(A(a)){c="";for(var f=0,g=a.length;f<g;++f)c+=d(this,b.push(a[f]));return c}return a?d(this,b.push(a)):"";case "function":var e=this;d=a.call(b.view,c,function(a){return e.render(a,b)});return null!=d?
d:"";default:if(a)return d(this,b)}return""};m.prototype._inverted=function(a,b,c){a=b.lookup(a);return!a||A(a)&&0===a.length?c(this,b):""};m.prototype._partial=function(a,b){!(a in this._partialCache)&&this._loadPartial&&this.compilePartial(a,this._loadPartial(a));var c=this._partialCache[a];return c?c(b):""};m.prototype._name=function(a,b){var c=b.lookup(a);"function"===typeof c&&(c=c.call(b.view));return null==c?"":String(c)};m.prototype._escaped=function(a,b){return h.escape(this._name(a,b))};
h.parse=function(a,b){a=a||"";b=b||h.tags;"string"===typeof b&&(b=b.split(y));if(2!==b.length)throw Error("Invalid tags: "+b.join(", "));for(var c=x(b),d=new t(a),f=[],g=[],e=[],k=!1,m=!1,n,l,p;!d.eos();){n=d.pos;if(p=d.scanUntil(c[0]))for(var r=0,q=p.length;r<q;++r)if(l=p.charAt(r),RegExp.prototype.test.call(C,l)?m=!0:e.push(g.length),g.push(["text",l,n,n+1]),n+=1,"\n"===l){if(k&&!m)for(;e.length;)g.splice(e.pop(),1);else e=[];m=k=!1}n=d.pos;if(!d.scan(c[0]))break;k=!0;l=d.scan(E)||"name";d.scan(B);
"="===l?(p=d.scanUntil(z),d.scan(z),d.scanUntil(c[1])):"{"===l?(p=RegExp("\\s*"+u("}"+b[1])),p=d.scanUntil(p),d.scan(D),d.scanUntil(c[1]),l="&"):p=d.scanUntil(c[1]);if(!d.scan(c[1]))throw Error("Unclosed tag at "+d.pos);if("/"===l){if(0===f.length)throw Error('Unopened section "'+p+'" at '+n);r=f.pop();if(r[1]!==p)throw Error('Unclosed section "'+r[1]+'" at '+n);}r=[l,p,n,d.pos];g.push(r);if("#"===l||"^"===l)f.push(r);else if("name"===l||"{"===l||"&"===l)m=!0;else if("="===l){b=p.split(y);if(2!==
b.length)throw Error("Invalid tags at "+n+": "+b.join(", "));c=x(b)}}if(r=f.pop())throw Error('Unclosed section "'+r[1]+'" at '+d.pos);for(var c=[],s,f=0,e=g.length;f<e;++f)d=g[f],"text"===d[0]&&s&&"text"===s[0]?(s[1]+=d[1],s[3]=d[3]):(s=d,c.push(d));s=g=[];d=[];e=0;for(k=c.length;e<k;++e)switch(f=c[e],f[0]){case "#":case "^":d.push(f);s.push(f);s=f[4]=[];break;case "/":d.pop()[5]=f[2];s=0<d.length?d[d.length-1][4]:g;break;default:s.push(f)}return g};var v=new m;h.clearCache=function(){return v.clearCache()};
h.compile=function(a,b){return v.compile(a,b)};h.compilePartial=function(a,b,c){return v.compilePartial(a,b,c)};h.compileTokens=function(a,b){return v.compileTokens(a,b)};h.render=function(a,b,c){return v.render(a,b,c)};h.to_html=function(a,b,c,d){a=h.render(a,b,c);if("function"===typeof d)d(a);else return a};return h}());
