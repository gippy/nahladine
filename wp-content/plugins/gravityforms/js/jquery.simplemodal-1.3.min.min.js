(function(b){var h=b.browser.msie&&6==parseInt(b.browser.version)&&"object"!=typeof window.XMLHttpRequest,k=null,c=[];b.modal=function(a,l){return b.modal.impl.init(a,l)};b.modal.close=function(){b.modal.impl.close()};b.fn.modal=function(a){return b.modal.impl.init(this,a)};b.modal.defaults={appendTo:"body",focus:!0,opacity:50,overlayId:"simplemodal-overlay",overlayCss:{},containerId:"simplemodal-container",containerCss:{},dataId:"simplemodal-data",dataCss:{},minHeight:200,minWidth:300,maxHeight:null,
maxWidth:null,autoResize:!1,zIndex:1E3,close:!0,closeHTML:'<a class="modalCloseImg" title="Close"></a>',closeClass:"simplemodal-close",escClose:!0,overlayClose:!1,position:null,persist:!1,onOpen:null,onShow:null,onClose:null};b.modal.impl={opts:null,dialog:{},init:function(a,l){if(this.dialog.data)return!1;k=b.browser.msie&&!b.boxModel;this.opts=b.extend({},b.modal.defaults,l);this.zIndex=this.opts.zIndex;this.occb=!1;if("object"==typeof a)a=a instanceof jQuery?a:b(a),0<a.parent().parent().size()&&
(this.dialog.parentNode=a.parent(),this.opts.persist||(this.dialog.orig=a.clone(!0)));else if("string"==typeof a||"number"==typeof a)a=b("<div/>").html(a);else return alert("SimpleModal Error: Unsupported data type: "+typeof a),!1;this.create(a);this.open();b.isFunction(this.opts.onShow)&&this.opts.onShow.apply(this,[this.dialog]);return this},create:function(a){c=this.getDimensions();h&&(this.dialog.iframe=b('<iframe src="javascript:false;"/>').css(b.extend(this.opts.iframeCss,{display:"none",opacity:0,
position:"fixed",height:c[0],width:c[1],zIndex:this.opts.zIndex,top:0,left:0})).appendTo(this.opts.appendTo));this.dialog.overlay=b("<div/>").attr("id",this.opts.overlayId).addClass("simplemodal-overlay").css(b.extend(this.opts.overlayCss,{display:"none",opacity:this.opts.opacity/100,height:c[0],width:c[1],position:"fixed",left:0,top:0,zIndex:this.opts.zIndex+1})).appendTo(this.opts.appendTo);this.dialog.container=b("<div/>").attr("id",this.opts.containerId).addClass("simplemodal-container").css(b.extend(this.opts.containerCss,
{display:"none",position:"fixed",zIndex:this.opts.zIndex+2})).append(this.opts.close&&this.opts.closeHTML?b(this.opts.closeHTML).addClass(this.opts.closeClass):"").appendTo(this.opts.appendTo);this.dialog.wrap=b("<div/>").attr("tabIndex",-1).addClass("simplemodal-wrap").css({height:"100%",outline:0,width:"100%"}).appendTo(this.dialog.container);this.dialog.data=a.attr("id",a.attr("id")||this.opts.dataId).addClass("simplemodal-data").css(b.extend(this.opts.dataCss,{display:"none"}));this.setContainerDimensions();
this.dialog.data.appendTo(this.dialog.wrap);(h||k)&&this.fixIE()},bindEvents:function(){var a=this;b("."+a.opts.closeClass).bind("click.simplemodal",function(b){b.preventDefault();a.close()});a.opts.close&&a.opts.overlayClose&&a.dialog.overlay.bind("click.simplemodal",function(b){b.preventDefault();a.close()});b(document).bind("keydown.simplemodal",function(b){a.opts.focus&&9==b.keyCode?a.watchTab(b):a.opts.close&&a.opts.escClose&&27==b.keyCode&&(b.preventDefault(),a.close())});b(window).bind("resize.simplemodal",
function(){c=a.getDimensions();a.opts.autoResize?a.setContainerDimensions():a.setPosition();h||k?a.fixIE():(a.dialog.iframe&&a.dialog.iframe.css({height:c[0],width:c[1]}),a.dialog.overlay.css({height:c[0],width:c[1]}))})},unbindEvents:function(){b("."+this.opts.closeClass).unbind("click.simplemodal");b(document).unbind("keydown.simplemodal");b(window).unbind("resize.simplemodal");this.dialog.overlay.unbind("click.simplemodal")},fixIE:function(){var a=this.opts.position;b.each([this.dialog.iframe||
null,this.dialog.overlay,this.dialog.container],function(b,c){if(c){var d=c[0].style;d.position="absolute";if(2>b)d.removeExpression("height"),d.removeExpression("width"),d.setExpression("height",'document.body.scrollHeight > document.body.clientHeight ? document.body.scrollHeight : document.body.clientHeight + "px"'),d.setExpression("width",'document.body.scrollWidth > document.body.clientWidth ? document.body.scrollWidth : document.body.clientWidth + "px"');else{var e,f;a&&a.constructor==Array?
(e=a[0]?"number"==typeof a[0]?a[0].toString():a[0].replace(/px/,""):c.css("top").replace(/px/,""),e=-1==e.indexOf("%")?e+' + (t = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "px"':parseInt(e.replace(/%/,""))+' * ((document.documentElement.clientHeight || document.body.clientHeight) / 100) + (t = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "px"',a[1]&&(f="number"==typeof a[1]?a[1].toString():
a[1].replace(/px/,""),f=-1==f.indexOf("%")?f+' + (t = document.documentElement.scrollLeft ? document.documentElement.scrollLeft : document.body.scrollLeft) + "px"':parseInt(f.replace(/%/,""))+' * ((document.documentElement.clientWidth || document.body.clientWidth) / 100) + (t = document.documentElement.scrollLeft ? document.documentElement.scrollLeft : document.body.scrollLeft) + "px"')):(e='(document.documentElement.clientHeight || document.body.clientHeight) / 2 - (this.offsetHeight / 2) + (t = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "px"',
f='(document.documentElement.clientWidth || document.body.clientWidth) / 2 - (this.offsetWidth / 2) + (t = document.documentElement.scrollLeft ? document.documentElement.scrollLeft : document.body.scrollLeft) + "px"');d.removeExpression("top");d.removeExpression("left");d.setExpression("top",e);d.setExpression("left",f)}}})},focus:function(a){a=b(":input:enabled:visible:"+(a||"first"),this.dialog.wrap);0<a.length?a.focus():this.dialog.wrap.focus()},getDimensions:function(){var a=b(window);return[b.browser.opera&&
"9.5"<b.browser.version&&"1.2.6">=b.fn.jquery?document.documentElement.clientHeight:b.browser.opera&&"9.5">b.browser.version&&"1.2.6"<b.fn.jquery?window.innerHeight:a.height(),a.width()]},getVal:function(a){return"auto"==a?0:parseInt(a.replace(/px/,""))},setContainerDimensions:function(){var a=this.getVal(this.dialog.container.css("height")),b=this.dialog.container.width(),g=this.dialog.data.height(),d=this.dialog.data.width(),e=this.opts.maxHeight&&this.opts.maxHeight<c[0]?this.opts.maxHeight:c[0],
f=this.opts.maxWidth&&this.opts.maxWidth<c[1]?this.opts.maxWidth:c[1],a=a?a>e?e:a:g?g>e?e:g<this.opts.minHeight?this.opts.minHeight:g:this.opts.minHeight,b=b?b>f?f:b:d?d>f?f:d<this.opts.minWidth?this.opts.minWidth:d:this.opts.minWidth;this.dialog.container.css({height:a,width:b});(g>a||d>b)&&this.dialog.wrap.css({overflow:"auto"});this.setPosition()},setPosition:function(){var a,b;a=c[0]/2-(this.dialog.container.height()||this.dialog.data.height())/2;b=c[1]/2-(this.dialog.container.width()||this.dialog.data.width())/
2;this.opts.position&&this.opts.position.constructor==Array&&(a=this.opts.position[0]||a,b=this.opts.position[1]||b);this.dialog.container.css({left:b,top:a})},watchTab:function(a){var c=this;if(0<b(a.target).parents(".simplemodal-container").length){if(c.inputs=b(":input:enabled:visible:first, :input:enabled:visible:last",c.dialog.data),!a.shiftKey&&a.target==c.inputs[c.inputs.length-1]||a.shiftKey&&a.target==c.inputs[0]||0==c.inputs.length){a.preventDefault();var g=a.shiftKey?"last":"first";setTimeout(function(){c.focus(g)},
10)}}else a.preventDefault(),setTimeout(function(){c.focus()},10)},open:function(){this.dialog.iframe&&this.dialog.iframe.show();b.isFunction(this.opts.onOpen)?this.opts.onOpen.apply(this,[this.dialog]):(this.dialog.overlay.show(),this.dialog.container.show(),this.dialog.data.show());this.focus();this.bindEvents()},close:function(){if(!this.dialog.data)return!1;this.unbindEvents();b.isFunction(this.opts.onClose)&&!this.occb?(this.occb=!0,this.opts.onClose.apply(this,[this.dialog])):(this.dialog.parentNode?
this.opts.persist?this.dialog.data.hide().appendTo(this.dialog.parentNode):(this.dialog.data.hide().remove(),this.dialog.orig.appendTo(this.dialog.parentNode)):this.dialog.data.hide().remove(),this.dialog.container.hide().remove(),this.dialog.overlay.hide().remove(),this.dialog.iframe&&this.dialog.iframe.hide().remove(),this.dialog={})}}})(jQuery);
